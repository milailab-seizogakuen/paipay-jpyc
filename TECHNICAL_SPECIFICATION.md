# PaiPay P2P - æŠ€è¡“ä»•æ§˜æ›¸ & JPYCç§»è¡Œæˆ¦ç•¥

**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå**: PaiPay P2P (painame-p2p)  
**ä½œæˆæ—¥**: 2025å¹´12æœˆ6æ—¥  
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: v2.0

---

## ğŸ“‹ ç›®æ¬¡

1. [ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦](#1-ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦)
2. [ç¾åœ¨ã®æŠ€è¡“ä»•æ§˜](#2-ç¾åœ¨ã®æŠ€è¡“ä»•æ§˜)
3. [ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è©³ç´°](#3-ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è©³ç´°)
4. [ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å®Ÿè£…](#4-ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å®Ÿè£…)
5. [JPYCç§»è¡Œæˆ¦ç•¥](#5-jpycç§»è¡Œæˆ¦ç•¥)
6. [å®Ÿè£…ãƒ•ã‚§ãƒ¼ã‚º](#6-å®Ÿè£…ãƒ•ã‚§ãƒ¼ã‚º)
7. [ãƒªã‚¹ã‚¯è©•ä¾¡ã¨å¯¾ç­–](#7-ãƒªã‚¹ã‚¯è©•ä¾¡ã¨å¯¾ç­–)
8. [ã‚³ã‚¹ãƒˆåˆ†æ](#8-ã‚³ã‚¹ãƒˆåˆ†æ)

---

## 1. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

### 1.1 ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ç›®çš„

PaiPay P2Pã¯ã€ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£å‘ã‘ã®P2Pæ±ºæ¸ˆã‚·ã‚¹ãƒ†ãƒ ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã§ã™ã€‚å­¦åœ’ç¥­ã€åœ°åŸŸé€šè²¨ã€ã‚µãƒ¼ã‚¯ãƒ«å†…é€šè²¨ãªã©ã€ã‚ã‚‰ã‚†ã‚‹ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã§ç‹¬è‡ªã®é€šè²¨ã‚·ã‚¹ãƒ†ãƒ ã‚’ç°¡å˜ã«æ§‹ç¯‰ã§ãã‚‹ã‚ˆã†ã«è¨­è¨ˆã•ã‚Œã¦ã„ã¾ã™ã€‚

### 1.2 ä¸»è¦æ©Ÿèƒ½

- ğŸ” **å®Œå…¨P2Pè¨­è¨ˆ**: ã‚µãƒ¼ãƒãƒ¼ã«ç§˜å¯†éµã‚’ä¿å­˜ã—ãªã„å®‰å…¨ãªã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£
- ğŸ“± **ãƒ¢ãƒã‚¤ãƒ«å¯¾å¿œ**: QRã‚³ãƒ¼ãƒ‰ã«ã‚ˆã‚‹ç°¡å˜ãªé€å—é‡‘
- ğŸ¨ **ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºå¯èƒ½**: ãƒˆãƒ¼ã‚¯ãƒ³åãƒ»è‰²ãƒ»ãƒ­ã‚´ã‚’è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã§å¤‰æ›´å¯èƒ½
- ğŸš€ **ç°¡å˜ãƒ‡ãƒ—ãƒ­ã‚¤**: Vercel/Netlifyã§å³åº§ã«å…¬é–‹å¯èƒ½
- ğŸ’° **ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒ¼ãƒ³**: é«˜é€Ÿãƒ»ä½ã‚³ã‚¹ãƒˆãªãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³

### 1.3 æƒ³å®šãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹

| ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ | èª¬æ˜ |
|------------|------|
| å­¦åœ’ç¥­ | æ¨¡æ“¬é€šè²¨ã¨ã—ã¦ä½¿ç”¨ã€å‡ºåº—ã§ã®æ±ºæ¸ˆ |
| åœ°åŸŸé€šè²¨ | åœ°åŸŸã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£å†…ã§ã®çµŒæ¸ˆæ´»æ€§åŒ– |
| ã‚¤ãƒ™ãƒ³ãƒˆ | æœŸé–“é™å®šã®ãƒˆãƒ¼ã‚¯ãƒ³ã‚·ã‚¹ãƒ†ãƒ  |
| ã‚µãƒ¼ã‚¯ãƒ« | ã‚°ãƒ«ãƒ¼ãƒ—å†…ãƒã‚¤ãƒ³ãƒˆãƒ»å ±é…¬ã‚·ã‚¹ãƒ†ãƒ  |
| å°è¦æ¨¡ãƒ“ã‚¸ãƒã‚¹ | ç‹¬è‡ªã®æ±ºæ¸ˆãƒ»ãƒã‚¤ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ  |

---

## 2. ç¾åœ¨ã®æŠ€è¡“ä»•æ§˜

### 2.1 æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

#### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
```typescript
{
  "framework": "Next.js 14.0.4",
  "language": "TypeScript 5.3.3",
  "ui": "React 18.2.0",
  "styling": "Tailwind CSS 3.4.0",
  "pwa": "next-pwa 5.6.0"
}
```

#### ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒ¼ãƒ³
```typescript
{
  "blockchain": "Sui Network",
  "network": "Testnet (æœ¬ç•ªã§ã¯Mainnet)",
  "sdk": "@mysten/sui 1.37.6",
  "rpcUrl": "https://fullnode.testnet.sui.io:443",
  "token": "PainAme Coin (PAC)",
  "decimals": 6
}
```

#### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ»æš—å·åŒ–
```typescript
{
  "keyGeneration": "bip39 (12å˜èªãƒ‹ãƒ¼ãƒ¢ãƒ‹ãƒƒã‚¯)",
  "encryption": "Web Crypto API (AES-GCM 256bit)",
  "keyDerivation": "PBKDF2 (100,000 iterations)",
  "storage": "IndexedDB",
  "signing": "Ed25519 (ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´)"
}
```

#### QRã‚³ãƒ¼ãƒ‰
```typescript
{
  "scanner": "html5-qrcode 2.3.8",
  "generator": "qrcode 1.5.4"
}
```

### 2.2 ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ 

```
painame-p2p/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/                    # Next.js App Router
â”‚   â”‚   â”œâ”€â”€ page.tsx           # ãƒ›ãƒ¼ãƒ ç”»é¢
â”‚   â”‚   â”œâ”€â”€ setup/             # ã‚¦ã‚©ãƒ¬ãƒƒãƒˆä½œæˆãƒ»å¾©å…ƒ
â”‚   â”‚   â”œâ”€â”€ wallet/            # ã‚¦ã‚©ãƒ¬ãƒƒãƒˆç”»é¢ï¼ˆæ®‹é«˜è¡¨ç¤ºï¼‰
â”‚   â”‚   â”œâ”€â”€ send/              # é€é‡‘ç”»é¢
â”‚   â”‚   â”œâ”€â”€ pin-setup/         # PINè¨­å®š
â”‚   â”‚   â”œâ”€â”€ pin-lock/          # PINãƒ­ãƒƒã‚¯ç”»é¢
â”‚   â”‚   â”œâ”€â”€ debug/             # ãƒ‡ãƒãƒƒã‚°ãƒ„ãƒ¼ãƒ«
â”‚   â”‚   â””â”€â”€ api/               # APIãƒ«ãƒ¼ãƒˆ
â”‚   â”œâ”€â”€ components/            # Reactã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â”œâ”€â”€ QRCodeDisplay.tsx  # QRã‚³ãƒ¼ãƒ‰è¡¨ç¤º
â”‚   â”‚   â”œâ”€â”€ QRScanner.tsx      # QRã‚¹ã‚­ãƒ£ãƒŠãƒ¼
â”‚   â”‚   â”œâ”€â”€ QRScannerWrapper.tsx
â”‚   â”‚   â””â”€â”€ PINInput.tsx       # PINå…¥åŠ›UI
â”‚   â”œâ”€â”€ lib/                   # ã‚³ã‚¢ãƒ­ã‚¸ãƒƒã‚¯
â”‚   â”‚   â”œâ”€â”€ keystore/          # éµç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ generate.ts    # ã‚¦ã‚©ãƒ¬ãƒƒãƒˆç”Ÿæˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ mnemonic.ts    # ãƒ‹ãƒ¼ãƒ¢ãƒ‹ãƒƒã‚¯ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ storage.ts     # IndexedDBæ“ä½œ
â”‚   â”‚   â”‚   â””â”€â”€ pin.ts         # PINãƒãƒƒã‚·ãƒ¥åŒ–
â”‚   â”‚   â”œâ”€â”€ crypto/            # æš—å·åŒ–
â”‚   â”‚   â”‚   â””â”€â”€ encryption.ts  # AES-GCMæš—å·åŒ–
â”‚   â”‚   â”œâ”€â”€ transaction/       # ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³
â”‚   â”‚   â”‚   â””â”€â”€ client-sign.ts # ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ç½²å
â”‚   â”‚   â”œâ”€â”€ sui/               # Suiçµ±åˆ
â”‚   â”‚   â”‚   â””â”€â”€ client.ts      # Suiã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
â”‚   â”‚   â”œâ”€â”€ painame.ts         # ãƒˆãƒ¼ã‚¯ãƒ³è¨­å®š
â”‚   â”‚   â””â”€â”€ debug/             # ãƒ‡ãƒãƒƒã‚°ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”‚   â””â”€â”€ config/                # è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
â”‚       â””â”€â”€ community.ts       # ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£è¨­å®š
â”œâ”€â”€ public/                    # é™çš„ãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ SECURITY.md               # ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¬ã‚¤ãƒ‰
â”œâ”€â”€ REQUIREMENTS_V2.md        # è¦ä»¶å®šç¾©æ›¸
â””â”€â”€ README.md                 # é–‹ç™ºè€…å‘ã‘ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
```

### 2.3 ç’°å¢ƒå¤‰æ•°

```bash
# .env.local
NEXT_PUBLIC_PAINAME_PACKAGE_ID=0x...        # Suiãƒˆãƒ¼ã‚¯ãƒ³ Package ID
NEXT_PUBLIC_PAINAME_TREASURY_CAP_ID=0x...   # Treasury Cap ID
NEXT_PUBLIC_SUI_NETWORK=testnet             # testnet | mainnet
NEXT_PUBLIC_DISTRIBUTOR_MNEMONIC=...        # ãƒ†ã‚¹ãƒˆç”¨é…å¸ƒå…ƒ
```

---

## 3. ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è©³ç´°

### 3.1 ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›³

```mermaid
graph TB
    subgraph "ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ (ãƒ–ãƒ©ã‚¦ã‚¶)"
        UI[React UI]
        Wallet[ã‚¦ã‚©ãƒ¬ãƒƒãƒˆç®¡ç†]
        Crypto[æš—å·åŒ–ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«]
        Signer[ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ç½²å]
        IDB[(IndexedDB)]
    end
    
    subgraph "Next.js ã‚µãƒ¼ãƒãƒ¼"
        API[API Routes]
        SSR[Server Side Rendering]
    end
    
    subgraph "Sui Blockchain"
        RPC[Sui RPC Node]
        Contract[PainAme Token Contract]
        Network[Sui Testnet/Mainnet]
    end
    
    UI --> Wallet
    Wallet --> Crypto
    Wallet --> IDB
    UI --> Signer
    Signer --> RPC
    API --> RPC
    RPC --> Contract
    Contract --> Network
    
    style Crypto fill:#ef4444
    style IDB fill:#ef4444
    style Signer fill:#ef4444
```

### 3.2 ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼

#### ã‚¦ã‚©ãƒ¬ãƒƒãƒˆä½œæˆãƒ•ãƒ­ãƒ¼

```mermaid
sequenceDiagram
    participant User
    participant UI
    participant Keystore
    participant Crypto
    participant IndexedDB
    
    User->>UI: ã‚¦ã‚©ãƒ¬ãƒƒãƒˆä½œæˆ
    UI->>Keystore: generateWallet()
    Keystore->>Keystore: bip39.generateMnemonic()
    Keystore->>Keystore: Ed25519Keypair.deriveKeypair()
    UI->>User: 12å˜èªè¡¨ç¤º
    User->>UI: PINå…¥åŠ›
    UI->>Crypto: encryptWithPassword(mnemonic, pin)
    Crypto->>Crypto: PBKDF2 + AES-GCM
    Crypto->>IndexedDB: æš—å·åŒ–ãƒ‡ãƒ¼ã‚¿ä¿å­˜
    IndexedDB-->>UI: ä¿å­˜å®Œäº†
```

#### é€é‡‘ãƒ•ãƒ­ãƒ¼ï¼ˆã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ç½²åï¼‰

```mermaid
sequenceDiagram
    participant User
    participant UI
    participant Signer
    participant SuiRPC
    participant Blockchain
    
    User->>UI: é€é‡‘æƒ…å ±å…¥åŠ›
    UI->>UI: PINå…¥åŠ›
    UI->>Signer: createAndSignTransaction()
    Signer->>Signer: ãƒ‹ãƒ¼ãƒ¢ãƒ‹ãƒƒã‚¯ã‹ã‚‰éµãƒšã‚¢å¾©å…ƒ
    Signer->>SuiRPC: getCoins() - æ®‹é«˜ç¢ºèª
    SuiRPC-->>Signer: ã‚³ã‚¤ãƒ³æƒ…å ±
    Signer->>Signer: ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³æ§‹ç¯‰
    Signer->>Signer: ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§ç½²å
    Signer->>SuiRPC: executeTransactionBlock()
    SuiRPC->>Blockchain: ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³é€ä¿¡
    Blockchain-->>UI: ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒãƒƒã‚·ãƒ¥
    UI->>User: é€é‡‘å®Œäº†é€šçŸ¥
```

### 3.3 ã‚³ã‚¢ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«è©³ç´°

#### 3.3.1 ã‚¦ã‚©ãƒ¬ãƒƒãƒˆç®¡ç† ([`keystore/storage.ts`](file:///Users/seizogakuen/Documents/painame-p2p/src/lib/keystore/storage.ts))

**è²¬å‹™**: ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã®æš—å·åŒ–ä¿å­˜ãƒ»èª­ã¿è¾¼ã¿

```typescript
interface WalletData {
  address: string;              // Suiã‚¢ãƒ‰ãƒ¬ã‚¹
  encryptedMnemonic: string;    // AES-GCMæš—å·åŒ–ã•ã‚ŒãŸãƒ‹ãƒ¼ãƒ¢ãƒ‹ãƒƒã‚¯
  iv: string;                   // åˆæœŸåŒ–ãƒ™ã‚¯ãƒˆãƒ« (Base64)
  salt: string;                 // ã‚½ãƒ«ãƒˆ (Base64)
  pinHash: string;              // PINã®SHA-256ãƒãƒƒã‚·ãƒ¥
  createdAt: number;            // ä½œæˆã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—
}
```

**ä¸»è¦é–¢æ•°**:
- `saveWallet(address, mnemonic, pin)`: ã‚¦ã‚©ãƒ¬ãƒƒãƒˆä¿å­˜
- `loadWallet(pin)`: ã‚¦ã‚©ãƒ¬ãƒƒãƒˆèª­ã¿è¾¼ã¿
- `hasWallet()`: ã‚¦ã‚©ãƒ¬ãƒƒãƒˆå­˜åœ¨ç¢ºèª
- `deleteWallet()`: ã‚¦ã‚©ãƒ¬ãƒƒãƒˆå‰Šé™¤

#### 3.3.2 æš—å·åŒ– ([`crypto/encryption.ts`](file:///Users/seizogakuen/Documents/painame-p2p/src/lib/crypto/encryption.ts))

**ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ **: AES-GCM 256bit + PBKDF2

```typescript
// æš—å·åŒ–ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
const ITERATIONS = 100000;      // PBKDF2åå¾©å›æ•°
const KEY_LENGTH = 256;         // AESéµé•·
const IV_LENGTH = 12;           // GCMåˆæœŸåŒ–ãƒ™ã‚¯ãƒˆãƒ«é•·
const SALT_LENGTH = 16;         // ã‚½ãƒ«ãƒˆé•·
```

**ä¸»è¦é–¢æ•°**:
- `encryptWithPassword(plaintext, password)`: æ–‡å­—åˆ—æš—å·åŒ–
- `decryptWithPassword(encrypted, password)`: æ–‡å­—åˆ—å¾©å·åŒ–

#### 3.3.3 ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ç½²å ([`transaction/client-sign.ts`](file:///Users/seizogakuen/Documents/painame-p2p/src/lib/transaction/client-sign.ts))

**ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£**: ãƒ‹ãƒ¼ãƒ¢ãƒ‹ãƒƒã‚¯ã‚’ã‚µãƒ¼ãƒãƒ¼ã«é€ä¿¡ã—ãªã„

```typescript
export async function createAndSignTransaction(params: SendTransactionParams) {
  // 1. ãƒ‹ãƒ¼ãƒ¢ãƒ‹ãƒƒã‚¯ã‹ã‚‰éµãƒšã‚¢å¾©å…ƒï¼ˆã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ï¼‰
  const keypair = Ed25519Keypair.deriveKeypair(mnemonic);
  
  // 2. ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³æ§‹ç¯‰
  const tx = new Transaction();
  tx.mergeCoins(...);
  tx.splitCoins(...);
  tx.transferObjects(...);
  
  // 3. ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§ç½²å
  const signedTx = await suiClient.signTransactionBlock({
    signer: keypair,
    transactionBlock: tx,
  });
  
  // 4. ç½²åæ¸ˆã¿ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã®ã¿ã‚’è¿”ã™
  return {
    signedTransaction: signedTx.transactionBlockBytes,
    signature: signedTx.signature,
    fromAddress,
  };
}
```

#### 3.3.4 Suiã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ ([`sui/client.ts`](file:///Users/seizogakuen/Documents/painame-p2p/src/lib/sui/client.ts))

**è²¬å‹™**: Sui RPCã¨ã®é€šä¿¡

```typescript
export const suiClient = new SuiClient({ 
  url: getFullnodeUrl('testnet')
});

// ä¸»è¦æ©Ÿèƒ½
- getBalance(address): æ®‹é«˜å–å¾—
- getCoins(owner, coinType): ã‚³ã‚¤ãƒ³ä¸€è¦§å–å¾—
- getTransactionHistory(address): ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å±¥æ­´å–å¾—
- signTransactionBlock(): ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ç½²å
- executeTransactionBlock(): ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
```

---

## 4. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å®Ÿè£…

### 4.1 ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­è¨ˆåŸå‰‡

> [!IMPORTANT]
> **Zero Trust Architecture**: ã‚µãƒ¼ãƒãƒ¼ã‚’ä¿¡é ¼ã—ãªã„è¨­è¨ˆ

1. **ç§˜å¯†éµã¯ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã®ã¿**: ã‚µãƒ¼ãƒãƒ¼ã«ç§˜å¯†éµãƒ»ãƒ‹ãƒ¼ãƒ¢ãƒ‹ãƒƒã‚¯ã‚’é€ä¿¡ã—ãªã„
2. **ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ç½²å**: ã™ã¹ã¦ã®ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã¯ãƒ–ãƒ©ã‚¦ã‚¶å†…ã§ç½²å
3. **å¼·åŠ›ãªæš—å·åŒ–**: AES-GCM 256bit + PBKDF2 (100,000 iterations)
4. **PINä¿è­·**: ãƒ¦ãƒ¼ã‚¶ãƒ¼è¨­å®šã®PINã§ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã‚’ä¿è­·

### 4.2 ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ©Ÿèƒ½

#### 4.2.1 ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ç½²å

**å¾“æ¥ã®å•é¡Œç‚¹**:
```typescript
// âŒ å±é™º: ãƒ‹ãƒ¼ãƒ¢ãƒ‹ãƒƒã‚¯ã‚’ã‚µãƒ¼ãƒãƒ¼ã«é€ä¿¡
fetch('/api/send', {
  body: JSON.stringify({
    mnemonic: wallet.mnemonic,  // â† ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯çµŒç”±ã§é€ä¿¡
    toAddress,
    amount,
  })
});
```

**æ”¹å–„å¾Œ**:
```typescript
// âœ… å®‰å…¨: ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§ç½²å
const signedTx = await createAndSignTransaction({
  mnemonic,  // â† ãƒ–ãƒ©ã‚¦ã‚¶å†…ã§ã®ã¿ä½¿ç”¨
  toAddress,
  amount,
});

fetch('/api/send', {
  body: JSON.stringify({
    signedTransaction: signedTx.signedTransaction,  // â† ç½²åæ¸ˆã¿ãƒ‡ãƒ¼ã‚¿ã®ã¿
    signature: signedTx.signature,
  })
});
```

#### 4.2.2 å¼·åŠ›ãªæš—å·åŒ–

**é–‹ç™ºç’°å¢ƒ** (ãƒ‡ãƒãƒƒã‚°ã—ã‚„ã™ã„):
```typescript
security: {
  requirePIN: false,
  showMnemonicInUI: true,
  useStrongEncryption: false,  // ã‚·ãƒ³ãƒ—ãƒ«ãªXORæš—å·åŒ–
}
```

**æœ¬ç•ªç’°å¢ƒ** (ã‚»ã‚­ãƒ¥ã‚¢):
```typescript
security: {
  requirePIN: true,
  showMnemonicInUI: false,
  useStrongEncryption: true,   // AES-GCM 256bit
}
```

#### 4.2.3 PINä¿è­·

```typescript
// PINè¨­å®šãƒ•ãƒ­ãƒ¼
1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒ6æ¡PINã‚’è¨­å®š
2. PBKDF2ã§PINã‚’ãƒãƒƒã‚·ãƒ¥åŒ–
3. PINã§ãƒ‹ãƒ¼ãƒ¢ãƒ‹ãƒƒã‚¯ã‚’æš—å·åŒ–
4. IndexedDBã«ä¿å­˜

// PINæ¤œè¨¼ãƒ•ãƒ­ãƒ¼
1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒPINã‚’å…¥åŠ›
2. ä¿å­˜ã•ã‚ŒãŸPINãƒãƒƒã‚·ãƒ¥ã¨æ¯”è¼ƒ
3. ä¸€è‡´ã™ã‚Œã°ãƒ‹ãƒ¼ãƒ¢ãƒ‹ãƒƒã‚¯ã‚’å¾©å·åŒ–
4. ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã«ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½
```

### 4.3 ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

æœ¬ç•ªç’°å¢ƒãƒ‡ãƒ—ãƒ­ã‚¤å‰ã«å¿…ãšç¢ºèª:

- [ ] `security.requirePIN: true`
- [ ] `security.showMnemonicInUI: false`
- [ ] `security.useStrongEncryption: true`
- [ ] HTTPSç’°å¢ƒã§ãƒ‡ãƒ—ãƒ­ã‚¤
- [ ] ç’°å¢ƒå¤‰æ•°ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã‚‹
- [ ] ãƒ‹ãƒ¼ãƒ¢ãƒ‹ãƒƒã‚¯ãŒãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ­ã‚°ã«å‡ºåŠ›ã•ã‚Œã¦ã„ãªã„
- [ ] DevToolsã§ãƒ‹ãƒ¼ãƒ¢ãƒ‹ãƒƒã‚¯ãŒè¦‹ãˆãªã„

---

## 5. JPYCç§»è¡Œæˆ¦ç•¥

### 5.1 ç§»è¡Œã®èƒŒæ™¯ã¨ç›®çš„

#### ç¾åœ¨ã®èª²é¡Œ

| èª²é¡Œ | èª¬æ˜ |
|------|------|
| **ç‹¬è‡ªãƒˆãƒ¼ã‚¯ãƒ³ã®ç®¡ç†è² æ‹…** | Suiä¸Šã§ã‚«ã‚¹ã‚¿ãƒ ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç™ºè¡Œãƒ»ç®¡ç†ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ |
| **æµå‹•æ€§ã®æ¬ å¦‚** | PainAmeã¯ç‹¬è‡ªãƒˆãƒ¼ã‚¯ãƒ³ã®ãŸã‚ã€å¤–éƒ¨ã§ã®äº¤æ›ãŒå›°é›£ |
| **ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ç†è§£ã‚³ã‚¹ãƒˆ** | æ–°ã—ã„ãƒˆãƒ¼ã‚¯ãƒ³ã®æ¦‚å¿µã‚’ç†è§£ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ |
| **ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒ¼ãƒ³ã®åˆ¶ç´„** | Suiã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ ã«ä¾å­˜ |

#### JPYCç§»è¡Œã®ãƒ¡ãƒªãƒƒãƒˆ

| ãƒ¡ãƒªãƒƒãƒˆ | èª¬æ˜ |
|---------|------|
| **æ³•å®šé€šè²¨ãƒšãƒƒã‚°** | 1 JPYC = 1 JPY ã®ä¾¡å€¤ãŒä¿è¨¼ã•ã‚Œã‚‹ |
| **æ—¢å­˜ã®æµå‹•æ€§** | æ—¢ã«å¤šãã®å–å¼•æ‰€ãƒ»ã‚µãƒ¼ãƒ“ã‚¹ã§åˆ©ç”¨å¯èƒ½ |
| **ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ç†è§£å®¹æ˜“æ€§** | æ—¥æœ¬å††ã¨åŒç­‰ã®ä¾¡å€¤ã§åˆ†ã‹ã‚Šã‚„ã™ã„ |
| **Polygonã®ä½ã‚³ã‚¹ãƒˆ** | ã‚¬ã‚¹ä»£ãŒéå¸¸ã«å®‰ã„ï¼ˆæ•°å††ç¨‹åº¦ï¼‰ |
| **EVMäº’æ›æ€§** | Ethereumã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ ã¨ã®äº’æ›æ€§ |
| **è¦åˆ¶å¯¾å¿œ** | æ—¥æœ¬ã®æ³•è¦åˆ¶ã«æº–æ‹ ã—ãŸã‚¹ãƒ†ãƒ¼ãƒ–ãƒ«ã‚³ã‚¤ãƒ³ |

### 5.2 æŠ€è¡“çš„å¤‰æ›´ç‚¹

#### 5.2.1 ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒ¼ãƒ³å¤‰æ›´

```diff
- Sui Network (Testnet/Mainnet)
+ Polygon Network (Mumbai Testnet / Mainnet)

- Sui RPC: https://fullnode.testnet.sui.io:443
+ Polygon RPC: https://polygon-rpc.com

- SDK: @mysten/sui
+ SDK: ethers.js / viem
```

#### 5.2.2 ãƒˆãƒ¼ã‚¯ãƒ³ä»•æ§˜å¤‰æ›´

| é …ç›® | ç¾åœ¨ (PainAme) | ç§»è¡Œå¾Œ (JPYC) |
|------|---------------|--------------|
| **ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒ¼ãƒ³** | Sui | Polygon |
| **ãƒˆãƒ¼ã‚¯ãƒ³è¦æ ¼** | Sui Coin | ERC-20 |
| **ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚¢ãƒ‰ãƒ¬ã‚¹** | ã‚«ã‚¹ã‚¿ãƒ  | 0x6AE7Dfc73E0dDE2aa99ac063DcF7e8A63265108c (Mainnet) |
| **ãƒ‡ã‚·ãƒãƒ«** | 6 | 18 |
| **ã‚·ãƒ³ãƒœãƒ«** | PAC | JPYC |
| **åå‰** | PainAme Coin | JPY Coin |
| **ä¾¡å€¤** | ç‹¬è‡ª | 1 JPYC = 1 JPY |

#### 5.2.3 ã‚¦ã‚©ãƒ¬ãƒƒãƒˆå¤‰æ›´

```diff
- Ed25519 éµãƒšã‚¢ (Sui)
+ secp256k1 éµãƒšã‚¢ (Ethereumäº’æ›)

- Sui Address (0x... 64æ–‡å­—)
+ Ethereum Address (0x... 40æ–‡å­—)

- ãƒ‹ãƒ¼ãƒ¢ãƒ‹ãƒƒã‚¯: BIP39 (Suiæ´¾ç”Ÿãƒ‘ã‚¹)
+ ãƒ‹ãƒ¼ãƒ¢ãƒ‹ãƒƒã‚¯: BIP39 (Ethereumæ´¾ç”Ÿãƒ‘ã‚¹: m/44'/60'/0'/0/0)
```

### 5.3 ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å¤‰æ›´

#### å¤‰æ›´å‰ (Sui)

```mermaid
graph LR
    Client[ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ] --> SuiSDK[@mysten/sui]
    SuiSDK --> SuiRPC[Sui RPC]
    SuiRPC --> PainAme[PainAme Contract]
```

#### å¤‰æ›´å¾Œ (Polygon + JPYC)

```mermaid
graph LR
    Client[ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ] --> Ethers[ethers.js]
    Ethers --> PolygonRPC[Polygon RPC]
    PolygonRPC --> JPYC[JPYC ERC-20 Contract]
```

### 5.4 å¿…è¦ãªã‚³ãƒ¼ãƒ‰å¤‰æ›´

#### 5.4.1 ä¾å­˜é–¢ä¿‚ã®å¤‰æ›´

```diff
// package.json
{
  "dependencies": {
-   "@mysten/sui": "^1.37.6",
+   "ethers": "^6.10.0",
+   "viem": "^2.0.0",  // ã‚ªãƒ—ã‚·ãƒ§ãƒ³: ã‚ˆã‚Šè»½é‡
    "bip39": "^3.1.0",  // å¤‰æ›´ãªã—
    "html5-qrcode": "^2.3.8",  // å¤‰æ›´ãªã—
    "qrcode": "^1.5.4",  // å¤‰æ›´ãªã—
  }
}
```

#### 5.4.2 è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®å¤‰æ›´

```typescript
// src/config/community.ts (å¤‰æ›´å¾Œ)
export const COMMUNITY_CONFIG = {
  token: {
    name: 'JPY Coin',
    symbol: 'JPYC',
    decimals: 18,  // ERC-20æ¨™æº–
  },
  
  branding: {
    appName: 'JPYC Pay',
    primaryColor: '#00D395',  // JPYCãƒ–ãƒ©ãƒ³ãƒ‰ã‚«ãƒ©ãƒ¼
    logoUrl: 'https://jpyc.jp/logo.png',
    backgroundColor: '#f0fdf4',
  },
  
  network: {
    type: 'polygon-mainnet' as const,
    chainId: 137,  // Polygon Mainnet
    rpcUrl: 'https://polygon-rpc.com',
    explorerUrl: 'https://polygonscan.com',
  },
  
  jpyc: {
    contractAddress: '0x6AE7Dfc73E0dDE2aa99ac063DcF7e8A63265108c',
    abi: [...],  // ERC-20 ABI
  },
};
```

#### 5.4.3 ã‚¦ã‚©ãƒ¬ãƒƒãƒˆç”Ÿæˆã®å¤‰æ›´

```typescript
// src/lib/keystore/generate.ts (å¤‰æ›´å¾Œ)
import { Wallet, HDNodeWallet } from 'ethers';
import * as bip39 from 'bip39';

export async function generateWallet() {
  // 1. ãƒ‹ãƒ¼ãƒ¢ãƒ‹ãƒƒã‚¯ç”Ÿæˆï¼ˆå¤‰æ›´ãªã—ï¼‰
  const mnemonic = bip39.generateMnemonic();
  
  // 2. Ethereumäº’æ›ã‚¦ã‚©ãƒ¬ãƒƒãƒˆç”Ÿæˆ
  const wallet = HDNodeWallet.fromPhrase(mnemonic);
  
  return {
    address: wallet.address,  // 0x... (40æ–‡å­—)
    mnemonic: mnemonic,
    privateKey: wallet.privateKey,
  };
}
```

#### 5.4.4 æ®‹é«˜å–å¾—ã®å¤‰æ›´

```typescript
// src/lib/polygon/client.ts (æ–°è¦ä½œæˆ)
import { ethers } from 'ethers';
import { COMMUNITY_CONFIG } from '@/config/community';

const provider = new ethers.JsonRpcProvider(COMMUNITY_CONFIG.network.rpcUrl);

const jpycContract = new ethers.Contract(
  COMMUNITY_CONFIG.jpyc.contractAddress,
  ['function balanceOf(address) view returns (uint256)'],
  provider
);

export async function getBalance(address: string) {
  // MATICæ®‹é«˜ï¼ˆã‚¬ã‚¹ä»£ç”¨ï¼‰
  const maticBalance = await provider.getBalance(address);
  
  // JPYCæ®‹é«˜
  const jpycBalance = await jpycContract.balanceOf(address);
  
  return {
    matic: Number(ethers.formatEther(maticBalance)),
    jpyc: Number(ethers.formatUnits(jpycBalance, 18)),
  };
}
```

#### 5.4.5 é€é‡‘å‡¦ç†ã®å¤‰æ›´

```typescript
// src/lib/transaction/client-sign.ts (å¤‰æ›´å¾Œ)
import { ethers } from 'ethers';
import { COMMUNITY_CONFIG } from '@/config/community';

export async function createAndSignTransaction(params: SendTransactionParams) {
  const { mnemonic, toAddress, amount } = params;
  
  // 1. ã‚¦ã‚©ãƒ¬ãƒƒãƒˆå¾©å…ƒ
  const wallet = ethers.Wallet.fromPhrase(mnemonic);
  const provider = new ethers.JsonRpcProvider(COMMUNITY_CONFIG.network.rpcUrl);
  const signer = wallet.connect(provider);
  
  // 2. JPYCã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆ
  const jpycContract = new ethers.Contract(
    COMMUNITY_CONFIG.jpyc.contractAddress,
    [
      'function transfer(address to, uint256 amount) returns (bool)',
      'function balanceOf(address) view returns (uint256)',
    ],
    signer
  );
  
  // 3. æ®‹é«˜ç¢ºèª
  const balance = await jpycContract.balanceOf(wallet.address);
  const amountWei = ethers.parseUnits(amount.toString(), 18);
  
  if (balance < amountWei) {
    throw new Error('æ®‹é«˜ãŒä¸è¶³ã—ã¦ã„ã¾ã™');
  }
  
  // 4. ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ä½œæˆãƒ»ç½²å
  const tx = await jpycContract.transfer(toAddress, amountWei);
  
  // 5. ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³é€ä¿¡
  const receipt = await tx.wait();
  
  return {
    txHash: receipt.hash,
    explorerUrl: `${COMMUNITY_CONFIG.network.explorerUrl}/tx/${receipt.hash}`,
  };
}
```

### 5.5 JPYC ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆæƒ…å ±

#### Polygon Mainnet

```typescript
{
  "contractAddress": "0x6AE7Dfc73E0dDE2aa99ac063DcF7e8A63265108c",
  "chainId": 137,
  "decimals": 18,
  "symbol": "JPYC",
  "name": "JPY Coin",
  "rpcUrl": "https://polygon-rpc.com",
  "explorerUrl": "https://polygonscan.com"
}
```

#### Mumbai Testnet (ãƒ†ã‚¹ãƒˆç”¨)

```typescript
{
  "contractAddress": "0x...",  // ãƒ†ã‚¹ãƒˆç”¨JPYCã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆ
  "chainId": 80001,
  "decimals": 18,
  "symbol": "JPYC",
  "name": "JPY Coin (Testnet)",
  "rpcUrl": "https://rpc-mumbai.maticvigil.com",
  "explorerUrl": "https://mumbai.polygonscan.com"
}
```

> [!WARNING]
> Mumbai Testnetã¯2024å¹´4æœˆã«å»ƒæ­¢äºˆå®šã§ã™ã€‚ä»£ã‚ã‚Šã«Amoy Testnetã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚

---

## 6. å®Ÿè£…ãƒ•ã‚§ãƒ¼ã‚º

### Phase 1: èª¿æŸ»ãƒ»æº–å‚™ (1-2æ—¥)

#### ã‚¿ã‚¹ã‚¯
- [ ] JPYCå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç¢ºèª
- [ ] Polygon RPCã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆé¸å®š
- [ ] ethers.js / viem ã®é¸å®š
- [ ] ãƒ†ã‚¹ãƒˆç”¨JPYCå–å¾—æ–¹æ³•ã®ç¢ºèª
- [ ] æ—¢å­˜ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã®ç§»è¡Œæ–¹æ³•æ¤œè¨

#### æˆæœç‰©
- æŠ€è¡“èª¿æŸ»ãƒ¬ãƒãƒ¼ãƒˆ
- ç§»è¡Œè¨ˆç”»æ›¸
- ãƒªã‚¹ã‚¯è©•ä¾¡æ›¸

### Phase 2: é–‹ç™ºç’°å¢ƒæ§‹ç¯‰ (1æ—¥)

#### ã‚¿ã‚¹ã‚¯
- [ ] ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
- [ ] Polygon Testnetæ¥ç¶šç¢ºèª
- [ ] ãƒ†ã‚¹ãƒˆç”¨ã‚¦ã‚©ãƒ¬ãƒƒãƒˆä½œæˆ
- [ ] ãƒ†ã‚¹ãƒˆç”¨JPYCå–å¾—

#### æ¤œè¨¼
```bash
# ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm install ethers@^6.10.0

# ãƒ†ã‚¹ãƒˆç”¨ã‚¦ã‚©ãƒ¬ãƒƒãƒˆä½œæˆ
node scripts/create-test-wallet.js

# Polygonæ¥ç¶šç¢ºèª
node scripts/test-polygon-connection.js
```

### Phase 3: ã‚³ã‚¢æ©Ÿèƒ½å®Ÿè£… (3-5æ—¥)

#### 3.1 ã‚¦ã‚©ãƒ¬ãƒƒãƒˆç®¡ç†

**å¤‰æ›´ãƒ•ã‚¡ã‚¤ãƒ«**:
- [`src/lib/keystore/generate.ts`](file:///Users/seizogakuen/Documents/painame-p2p/src/lib/keystore/generate.ts)
- [`src/lib/keystore/mnemonic.ts`](file:///Users/seizogakuen/Documents/painame-p2p/src/lib/keystore/mnemonic.ts)

**å¤‰æ›´å†…å®¹**:
```typescript
// Sui â†’ Ethereumäº’æ›ã‚¦ã‚©ãƒ¬ãƒƒãƒˆç”Ÿæˆ
- Ed25519Keypair.deriveKeypair()
+ HDNodeWallet.fromPhrase()
```

#### 3.2 Polygonã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ

**æ–°è¦ãƒ•ã‚¡ã‚¤ãƒ«**:
- `src/lib/polygon/client.ts`
- `src/lib/polygon/jpyc.ts`

**å®Ÿè£…å†…å®¹**:
- ethers.js ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼è¨­å®š
- JPYCã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
- æ®‹é«˜å–å¾—é–¢æ•°
- ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å±¥æ­´å–å¾—

#### 3.3 ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ç½²å

**å¤‰æ›´ãƒ•ã‚¡ã‚¤ãƒ«**:
- [`src/lib/transaction/client-sign.ts`](file:///Users/seizogakuen/Documents/painame-p2p/src/lib/transaction/client-sign.ts)

**å¤‰æ›´å†…å®¹**:
```typescript
// Sui Transaction â†’ ERC-20 Transfer
- new Transaction()
- tx.mergeCoins()
- tx.splitCoins()
- tx.transferObjects()
+ jpycContract.transfer(to, amount)
```

#### 3.4 UIæ›´æ–°

**å¤‰æ›´ãƒ•ã‚¡ã‚¤ãƒ«**:
- [`src/app/wallet/page.tsx`](file:///Users/seizogakuen/Documents/painame-p2p/src/app/wallet/page.tsx)
- [`src/app/send/page.tsx`](file:///Users/seizogakuen/Documents/painame-p2p/src/app/send/page.tsx)
- [`src/config/community.ts`](file:///Users/seizogakuen/Documents/painame-p2p/src/config/community.ts)

**å¤‰æ›´å†…å®¹**:
- ãƒˆãƒ¼ã‚¯ãƒ³å: PainAme â†’ JPYC
- ãƒ‡ã‚·ãƒãƒ«: 6 â†’ 18
- ã‚¬ã‚¹ä»£è¡¨ç¤º: SUI â†’ MATIC
- ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ãƒ¼ãƒ©ãƒ¼ãƒªãƒ³ã‚¯: Sui â†’ Polygon

### Phase 4: ãƒ†ã‚¹ãƒˆ (2-3æ—¥)

#### 4.1 å˜ä½“ãƒ†ã‚¹ãƒˆ

```typescript
// tests/wallet.test.ts
describe('Wallet Generation', () => {
  it('should generate Ethereum-compatible wallet', async () => {
    const wallet = await generateWallet();
    expect(wallet.address).toMatch(/^0x[a-fA-F0-9]{40}$/);
  });
});

// tests/jpyc.test.ts
describe('JPYC Balance', () => {
  it('should fetch JPYC balance', async () => {
    const balance = await getBalance(TEST_ADDRESS);
    expect(balance.jpyc).toBeGreaterThanOrEqual(0);
  });
});
```

#### 4.2 çµ±åˆãƒ†ã‚¹ãƒˆ

**ãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ª**:
1. ã‚¦ã‚©ãƒ¬ãƒƒãƒˆä½œæˆ
2. ãƒ†ã‚¹ãƒˆç”¨JPYCå—ã‘å–ã‚Š
3. åˆ¥ã‚¢ãƒ‰ãƒ¬ã‚¹ã¸é€é‡‘
4. æ®‹é«˜ç¢ºèª
5. ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å±¥æ­´ç¢ºèª

#### 4.3 E2Eãƒ†ã‚¹ãƒˆ

**ãƒ–ãƒ©ã‚¦ã‚¶ãƒ†ã‚¹ãƒˆ**:
- [ ] ã‚¦ã‚©ãƒ¬ãƒƒãƒˆä½œæˆãƒ•ãƒ­ãƒ¼
- [ ] QRã‚³ãƒ¼ãƒ‰å—å–
- [ ] QRã‚³ãƒ¼ãƒ‰ã‚¹ã‚­ãƒ£ãƒ³é€é‡‘
- [ ] PINè¨­å®šãƒ»ãƒ­ãƒƒã‚¯
- [ ] ãƒ¢ãƒã‚¤ãƒ«ãƒ–ãƒ©ã‚¦ã‚¶å‹•ä½œç¢ºèª

### Phase 5: ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ»ç§»è¡Œ (1-2æ—¥)

#### 5.1 ç’°å¢ƒå¤‰æ•°è¨­å®š

```bash
# Vercel / Netlify
NEXT_PUBLIC_JPYC_CONTRACT_ADDRESS=0x6AE7Dfc73E0dDE2aa99ac063DcF7e8A63265108c
NEXT_PUBLIC_POLYGON_NETWORK=mainnet
NEXT_PUBLIC_POLYGON_RPC_URL=https://polygon-rpc.com
NEXT_PUBLIC_POLYGON_CHAIN_ID=137
```

#### 5.2 æ—¢å­˜ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ç§»è¡Œ

> [!CAUTION]
> æ—¢å­˜ã®Suiã‚¦ã‚©ãƒ¬ãƒƒãƒˆã¯ä½¿ç”¨ã§ããªããªã‚Šã¾ã™

**ç§»è¡Œæ–¹æ³•**:
1. æ—¢å­˜ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã®ãƒ‹ãƒ¼ãƒ¢ãƒ‹ãƒƒã‚¯ã‚’ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
2. æ–°ã—ã„Polygonå¯¾å¿œã‚¦ã‚©ãƒ¬ãƒƒãƒˆã‚’ä½œæˆ
3. å¿…è¦ã«å¿œã˜ã¦è³‡ç”£ã‚’ç§»è¡Œï¼ˆæ‰‹å‹•ï¼‰

**ç§»è¡Œãƒ„ãƒ¼ãƒ«** (ã‚ªãƒ—ã‚·ãƒ§ãƒ³):
```typescript
// scripts/migrate-wallet.ts
// Suiãƒ‹ãƒ¼ãƒ¢ãƒ‹ãƒƒã‚¯ â†’ Polygonã‚¦ã‚©ãƒ¬ãƒƒãƒˆå¤‰æ›ãƒ„ãƒ¼ãƒ«
```

#### 5.3 æœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤

```bash
# ãƒ“ãƒ«ãƒ‰ç¢ºèª
npm run build

# Vercelãƒ‡ãƒ—ãƒ­ã‚¤
vercel --prod

# å‹•ä½œç¢ºèª
- ã‚¦ã‚©ãƒ¬ãƒƒãƒˆä½œæˆ
- JPYCå—ã‘å–ã‚Š
- JPYCé€é‡‘
- ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ç¢ºèª
```

---

## 7. ãƒªã‚¹ã‚¯è©•ä¾¡ã¨å¯¾ç­–

### 7.1 æŠ€è¡“çš„ãƒªã‚¹ã‚¯

| ãƒªã‚¹ã‚¯ | å½±éŸ¿åº¦ | ç¢ºç‡ | å¯¾ç­– |
|--------|--------|------|------|
| **Polygon RPCéšœå®³** | é«˜ | ä¸­ | è¤‡æ•°ã®RPCã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’ç”¨æ„ |
| **JPYCæµå‹•æ€§ä¸è¶³** | ä¸­ | ä½ | äº‹å‰ã«å–å¼•æ‰€ã§ç¢ºèª |
| **ã‚¬ã‚¹ä»£é«˜é¨°** | ä¸­ | ä½ | Polygonã¯é€šå¸¸ä½ã‚³ã‚¹ãƒˆã€ç›£è¦–ã‚’å®Ÿæ–½ |
| **ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆãƒã‚°** | é«˜ | ä½ | JPYCå…¬å¼ç›£æŸ»æ¸ˆã¿ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚’ä½¿ç”¨ |
| **ã‚¦ã‚©ãƒ¬ãƒƒãƒˆç§»è¡Œå¤±æ•—** | é«˜ | ä¸­ | ååˆ†ãªãƒ†ã‚¹ãƒˆæœŸé–“ã‚’è¨­ã‘ã‚‹ |

### 7.2 ãƒ“ã‚¸ãƒã‚¹ãƒªã‚¹ã‚¯

| ãƒªã‚¹ã‚¯ | å½±éŸ¿åº¦ | ç¢ºç‡ | å¯¾ç­– |
|--------|--------|------|------|
| **ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ··ä¹±** | ä¸­ | é«˜ | è©³ç´°ãªç§»è¡Œã‚¬ã‚¤ãƒ‰ä½œæˆ |
| **æ—¢å­˜ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®é›¢è„±** | ä¸­ | ä¸­ | ç§»è¡Œã‚¤ãƒ³ã‚»ãƒ³ãƒ†ã‚£ãƒ–æä¾› |
| **è¦åˆ¶å¤‰æ›´** | é«˜ | ä½ | JPYCå…¬å¼ã®è¦åˆ¶å¯¾å¿œçŠ¶æ³ã‚’ç›£è¦– |

### 7.3 ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒªã‚¹ã‚¯

| ãƒªã‚¹ã‚¯ | å½±éŸ¿åº¦ | ç¢ºç‡ | å¯¾ç­– |
|--------|--------|------|------|
| **ãƒ•ã‚£ãƒƒã‚·ãƒ³ã‚°æ”»æ’ƒ** | é«˜ | ä¸­ | ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•™è‚²ã€å…¬å¼ãƒ‰ãƒ¡ã‚¤ãƒ³æ˜ç¤º |
| **ç§˜å¯†éµæ¼æ´©** | é«˜ | ä½ | ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ç½²åã®å¾¹åº• |
| **ä¸­é–“è€…æ”»æ’ƒ** | é«˜ | ä½ | HTTPSå¿…é ˆã€è¨¼æ˜æ›¸æ¤œè¨¼ |

---

## 8. ã‚³ã‚¹ãƒˆåˆ†æ

### 8.1 é–‹ç™ºã‚³ã‚¹ãƒˆ

| é …ç›® | å·¥æ•° | å‚™è€ƒ |
|------|------|------|
| èª¿æŸ»ãƒ»æº–å‚™ | 1-2æ—¥ | JPYCä»•æ§˜ç¢ºèªã€æŠ€è¡“é¸å®š |
| é–‹ç™ºç’°å¢ƒæ§‹ç¯‰ | 1æ—¥ | ä¾å­˜é–¢ä¿‚ã€ãƒ†ã‚¹ãƒˆç’°å¢ƒ |
| ã‚³ã‚¢æ©Ÿèƒ½å®Ÿè£… | 3-5æ—¥ | ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã€é€é‡‘ã€UI |
| ãƒ†ã‚¹ãƒˆ | 2-3æ—¥ | å˜ä½“ã€çµ±åˆã€E2E |
| ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ»ç§»è¡Œ | 1-2æ—¥ | æœ¬ç•ªç’°å¢ƒã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ç§»è¡Œ |
| **åˆè¨ˆ** | **8-13æ—¥** | 1äººã®ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã®å ´åˆ |

### 8.2 é‹ç”¨ã‚³ã‚¹ãƒˆ

#### Sui (ç¾åœ¨)

| é …ç›® | ã‚³ã‚¹ãƒˆ |
|------|--------|
| ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³æ‰‹æ•°æ–™ | ç´„0.001 SUI/tx (ç´„0.1å††) |
| RPCãƒãƒ¼ãƒ‰ | ç„¡æ–™ (å…¬å¼RPCä½¿ç”¨) |
| ãƒˆãƒ¼ã‚¯ãƒ³ç™ºè¡Œãƒ»ç®¡ç† | åˆæœŸã‚³ã‚¹ãƒˆã‚ã‚Š |

#### Polygon + JPYC (ç§»è¡Œå¾Œ)

| é …ç›® | ã‚³ã‚¹ãƒˆ |
|------|--------|
| ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³æ‰‹æ•°æ–™ | ç´„0.001 MATIC/tx (ç´„0.1å††) |
| RPCãƒãƒ¼ãƒ‰ | ç„¡æ–™ (å…¬å¼RPCä½¿ç”¨) |
| ãƒˆãƒ¼ã‚¯ãƒ³ç™ºè¡Œãƒ»ç®¡ç† | ä¸è¦ (JPYCä½¿ç”¨) |

> [!TIP]
> ã‚¬ã‚¹ä»£ã¯ã»ã¼åŒç­‰ã§ã™ãŒã€ãƒˆãƒ¼ã‚¯ãƒ³ç®¡ç†ã‚³ã‚¹ãƒˆãŒå‰Šæ¸›ã•ã‚Œã¾ã™

### 8.3 ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚³ã‚¹ãƒˆ

| é …ç›® | Sui (ç¾åœ¨) | Polygon + JPYC (ç§»è¡Œå¾Œ) |
|------|-----------|----------------------|
| **ã‚¦ã‚©ãƒ¬ãƒƒãƒˆä½œæˆ** | ç„¡æ–™ | ç„¡æ–™ |
| **é€é‡‘æ‰‹æ•°æ–™** | ç´„0.1å†† | ç´„0.1å†† |
| **JPYCè³¼å…¥** | - | å–å¼•æ‰€æ‰‹æ•°æ–™ (0.1-1%) |
| **JPYCæ›é‡‘** | - | å–å¼•æ‰€æ‰‹æ•°æ–™ (0.1-1%) |

---

## 9. ã¾ã¨ã‚

### 9.1 ç¾åœ¨ã®ã‚·ã‚¹ãƒ†ãƒ ã®å¼·ã¿

- âœ… **ã‚»ã‚­ãƒ¥ã‚¢**: ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ç½²åã€AES-GCMæš—å·åŒ–
- âœ… **P2P**: ã‚µãƒ¼ãƒãƒ¼ã«ç§˜å¯†éµã‚’ä¿å­˜ã—ãªã„
- âœ… **ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºå¯èƒ½**: è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã§ç°¡å˜ã«å¤‰æ›´
- âœ… **ãƒ¢ãƒã‚¤ãƒ«å¯¾å¿œ**: QRã‚³ãƒ¼ãƒ‰ã§ç°¡å˜é€å—é‡‘
- âœ… **ä½ã‚³ã‚¹ãƒˆ**: Suiã®é«˜é€Ÿãƒ»ä½ã‚³ã‚¹ãƒˆãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³

### 9.2 JPYCç§»è¡Œã®æ¨å¥¨ç†ç”±

1. **æ³•å®šé€šè²¨ãƒšãƒƒã‚°**: 1 JPYC = 1 JPY ã§ä¾¡å€¤ãŒå®‰å®š
2. **æ—¢å­˜ã®æµå‹•æ€§**: å–å¼•æ‰€ã§ç°¡å˜ã«å£²è²·å¯èƒ½
3. **ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ç†è§£å®¹æ˜“æ€§**: æ—¥æœ¬å††ã¨åŒç­‰ã§åˆ†ã‹ã‚Šã‚„ã™ã„
4. **Polygonã®ä½ã‚³ã‚¹ãƒˆ**: ã‚¬ã‚¹ä»£ãŒéå¸¸ã«å®‰ã„
5. **è¦åˆ¶å¯¾å¿œ**: æ—¥æœ¬ã®æ³•è¦åˆ¶ã«æº–æ‹ 

### 9.3 æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

1. **Phase 1**: JPYCå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç¢ºèªã€æŠ€è¡“èª¿æŸ»
2. **Phase 2**: é–‹ç™ºç’°å¢ƒæ§‹ç¯‰ã€Polygonæ¥ç¶šç¢ºèª
3. **Phase 3**: ã‚³ã‚¢æ©Ÿèƒ½å®Ÿè£…ï¼ˆã‚¦ã‚©ãƒ¬ãƒƒãƒˆã€é€é‡‘ã€UIï¼‰
4. **Phase 4**: ãƒ†ã‚¹ãƒˆï¼ˆå˜ä½“ã€çµ±åˆã€E2Eï¼‰
5. **Phase 5**: æœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ç§»è¡Œ

---

## ä»˜éŒ²

### A. å‚è€ƒãƒªãƒ³ã‚¯

- [JPYCå…¬å¼ã‚µã‚¤ãƒˆ](https://jpyc.jp/)
- [Polygonå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://docs.polygon.technology/)
- [ethers.js ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://docs.ethers.org/)
- [ERC-20 æ¨™æº–ä»•æ§˜](https://eips.ethereum.org/EIPS/eip-20)

### B. ç”¨èªé›†

| ç”¨èª | èª¬æ˜ |
|------|------|
| **JPYC** | æ—¥æœ¬å††ãƒšãƒƒã‚°ã®ã‚¹ãƒ†ãƒ¼ãƒ–ãƒ«ã‚³ã‚¤ãƒ³ (1 JPYC = 1 JPY) |
| **Polygon** | Ethereumã®ãƒ¬ã‚¤ãƒ¤ãƒ¼2ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ |
| **ERC-20** | Ethereumãƒˆãƒ¼ã‚¯ãƒ³ã®æ¨™æº–è¦æ ¼ |
| **AES-GCM** | èªè¨¼ä»˜ãæš—å·åŒ–ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ  |
| **PBKDF2** | ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹éµå°å‡ºé–¢æ•° |
| **BIP39** | ãƒ‹ãƒ¼ãƒ¢ãƒ‹ãƒƒã‚¯ãƒ•ãƒ¬ãƒ¼ã‚ºã®æ¨™æº–è¦æ ¼ |

---

**ä½œæˆè€…**: Antigravity AI  
**æœ€çµ‚æ›´æ–°**: 2025å¹´12æœˆ6æ—¥
